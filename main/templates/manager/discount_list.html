{% extends 'base_generic.html' %}

{% block content %}
<div class="container mt-5">
  <!-- دکمه بازگشت -->
  <div class="mb-3">
    <a href="{% url 'manager_dashboard' %}" class="btn btn-secondary">
      <i class="fas fa-arrow-left"></i> Back to Dashboard
    </a>
  </div>

  <!-- عنوان صفحه -->
  <h2 class="text-primary">Manage Discount Codes</h2>
  <hr>

  <!-- فرم افزودن کد تخفیف -->
  <div class="card mb-4 shadow-sm" style="border-radius: 8px;">
    <div class="card-body">
      <h4 class="text-success mb-4">Add New Discount Code</h4>
      <form method="post" class="needs-validation" novalidate>
        {% csrf_token %}
        <div class="form-group mb-3">
          <label for="id_code" class="form-label">Code:</label>
          {{ form.code}}
        </div>
        <div class="form-group mb-3">
          <label for="id_percent" class="form-label">Percent:</label>
          {{ form.percent}}
        </div>
        <div class="form-group mb-3">
          <label for="id_expires_at" class="form-label">Expires At:</label>
          {{ form.expires_at }}
        </div>
        <button type="submit" class="btn btn-primary w-100">
          <i class="fas fa-plus-circle"></i> Add Discount
        </button>
      </form>
    </div>
  </div>

  <!-- لیست کدهای تخفیف -->
  <div class="card shadow-sm" style="border-radius: 8px;">
    <div class="card-body">
      <h4 class="text-info mb-4">Existing Discount Codes</h4>
      <table class="table table-bordered table-hover">
        <thead class="table-light">
          <tr>
            <th>Code</th>
            <th>Percent</th>
            <th>Expires At</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for discount in discounts %}
          <tr>
            <td>{{ discount.code }}</td>
            <td>{{ discount.percent }}%</td>
            <td>{{ discount.expires_at }}</td>
            <td>
              <form method="post" action="{% url 'discount_delete' discount.pk %}" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger btn-sm">
                  <i class="fas fa-trash-alt"></i> Delete
                </button>
              </form>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="4" class="text-center text-muted">No discount codes found.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
